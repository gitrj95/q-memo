/ TODO
/ bugs with rm. doesn't clear cache tables. clean up rm.
/ stylize interface
/ build example cases
/ stylize documentation
/ pub

\d .memo
cap:100;p:`cache;ac:()!();fs:enlist[::]!enlist(::);et:2!+`f`a`r!(`g#,`;,(::);,(::))
sc:{?[x;,(=;`f;ws y);0b;()]};tc:{![x;,(within;`i;(enlist;1;(+;-:1+cap;(#:;`i))));0b;0#`]};ec:{![x;,(=;`f;ws y);0b;0#`]};ed:{![."\\d";();0b;,x]}
ns:{(x[1]in`,!`)&2=#x:`\:x};ws:{$[11=abs@@x;,x;x]};f:{'[{[c;f;n;a]r:?[c;((=;`f;ws n);(~\:;`a;ws a));0b;()];$[#r;**. r;[.[c;();,;(n;a;r:f . a)];tc c;r]]}[x;y;z];enlist]}

init:{d:$[^x;."\\d";$[ns x;x;'x]];i:0;while[~()~!n:.Q.dd/d,p,i;i+:1];ac[d],:n;.[n;();:;et]}
mk:{a:$[-11=@y;$[-11=@x;(. x;x^y);(99<@x)&~^y;(x;y);'`type];'`type];d:."\\d";if[~d in!ac;'`init];c:(:/ac d);fs[x]:a 1;.[:/a;();:;f . c,a]}
rm:{if[~-11=@x;'`type];$[-11=@l:fs?x;$[l~x;[d:(.*.. l);ec . d 1 3;fs _:l;.[:/d;();:;d 2]];[ec .(.*.. x)1 3;fs _:l;ed x;l]];[ed x;fs _:l;l]]} / cleanup. all use ec, fs _:, ed
mv:{if[~11=@x,y;'`type];d:.*.. x;.[y;();,;sc . d 1 3];tc y;ec . d 1 3;.[d 3;();:;f . y,d 2 3]}

